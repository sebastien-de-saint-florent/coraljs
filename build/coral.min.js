/*! coraljs 0.1 "Early Preview" - license MIT - http://coraljs.com */
function $Bind(a){return Coral.Bind.simpleBindingExp.test(a)?new Coral.Bind(a.substring(1,a.length-1),Coral.Bind.SIMPLE_BINDING_MODE):Coral.Bind.compositeBindingExp.test(a)?new Coral.Bind(a,Coral.Bind.COMPOSITE_BINDING_MODE):new Coral.Bind(a,Coral.Bind.SIMPLE_BINDING_MODE)}function $BindState(a){return new Coral.BindState(a)}function $Descriptor(a,b){return new Coral.Descriptor(a,b)}function $Description(a,b){return new Coral.Descriptor(void 0,b)}function $DescribableObject(a){return new Coral.Descriptor(Coral.DescribableObject,a)}function $Task(a){return new Coral.Descriptor(Coral.Task,a)}function $SequentialTasks(a){return new Coral.Descriptor(Coral.SequentialTasks,a)}function $ParallelTasks(a){return new Coral.Descriptor(Coral.ParallelTasks,a)}function $DescriptorsFactory(a){return new Coral.Descriptor(Coral.DescriptorsFactory,a)}function $DataDescriptorsFactory(a){return new Coral.Descriptor(Coral.DataDescriptorsFactory,a)}function $ActionMap(a){return new Coral.Descriptor(Coral.ActionMap,a)}function $Action(a){return new Coral.Descriptor(Coral.Action,a)}function $NavigationMap(a){return new Coral.Descriptor(Coral.NavigationMap,a)}function $NavigationAction(a){return new Coral.Descriptor(Coral.NavigationAction,a)}function $MethodTask(a){return new Coral.Descriptor(Coral.MethodTask,a)}function $SetTask(a){return new Coral.Descriptor(Coral.SetTask,a)}function $Component(a){return new Coral.Descriptor(Coral.Component,a)}function $State(a){return new Coral.Descriptor(Coral.State,a)}function $StateValue(a){return new Coral.Descriptor(Coral.StateValue,a)}function $Transition(a){return new Coral.Descriptor(Coral.Transition,a)}function $IntermediateState(a){return new Coral.Descriptor(Coral.IntermediateState,a)}function $Container(a){return new Coral.Descriptor(Coral.Container,a)}function $DataContainer(a){return new Coral.Descriptor(Coral.DataContainer,a)}function $Application(a){return new Coral.Descriptor(Coral.Application,a)}var Coral;!function(a){!function(a){function b(a){var b=a.id||a.uid,c=a.constructor.name||"Object";return b?"["+c+" #"+b+"]":"["+c+"]"}function c(b,c,d){throw c&&(b=a.objectInfo(c)+" "+b),d&&(b+=" : "+d),b}function d(b,c,d){c&&(b=a.objectInfo(c)+" "+b),d&&(b+=" : "+d),console.warn(b)}function e(){return++l}function f(a,b){for(var c=Array.isArray(b)?b:b.split("."),d=0;d<c.length;++d){var e=c[d],f=!1,g=k.exec(e);if(g&&g.length>0&&(f=!0,e=g[1]),!(a&&e in a))return void 0;a=f?a[e]():a[e]}return a}function g(a,b){for(var c=[],d=a;d;){if(d.hasOwnProperty(b)){var e=d[b];e&&(Array.isArray(e)?c=c.concat(e):c.push(e))}d=Object.getPrototypeOf(d)}return c}function h(a,b,c){setTimeout(function(){b.call(c)},a)}function i(b,c){a.wait(10,b,c)}function j(a,b,c){var d={};if(a)for(var e in a)if(b){var f=b.exec(e);!f||c&&c.test(e)||(d[f[1]]=a[e])}else c&&!c.test(e)&&(d[e]=a[e]);return d}var k=/(.*)\(\s*\)/;a.objectInfo=b,a.error=c,a.warning=d;var l=0;a.getUID=e,a.getChain=f,a.prototypalMerge=g,a.wait=h,a.callback=i,a.objectFilter=j}(a.Utils||(a.Utils={})),a.Utils}(Coral||(Coral={}));var Meta;!function(a){!function(a){function b(a,b){for(var c=a;c&&!c.hasOwnProperty(b);)c=Object.getPrototypeOf(c);return c||a}function c(a,b){var c=Object.getOwnPropertyDescriptor(a,b);return c&&c.writable&&(!c.configurable||Object.isSealed(a)||!Object.isExtensible(a)||Object.isFrozen(a))?!1:!0}function d(a,b,c,d,e){Object.defineProperty(a,c,d),Object.defineProperty(a,b,e)}a.findPropertyDefinition=b,a.canWrapProperty=c,a.wrapProperty=d}(a.Utils||(a.Utils={})),a.Utils}(Meta||(Meta={}));var Meta;!function(a){function b(a,b){var c=Object.create(b.prototype);a.prototype=c,a.prototype.constructor=a,a.superConstructor=b}function c(b,c,d){var e=b.constructor=b.hasOwnProperty("constructor")?b.constructor:c?function(){c.apply(this,arguments)}:function(){};if(c){a.Extends(e,c);for(var f=Object.getOwnPropertyNames(b),g=0;g<f.length;++g)Object.defineProperty(e.prototype,f[g],Object.getOwnPropertyDescriptor(b,f[g]))}else e.prototype=b;if(d)for(var g=0;g<d.length;++g)a.Mixin(e.prototype,d[g]);return e}function d(b,c){c.hasOwnProperty(a.Mixin.MIXIN_NAME_KEY)||Object.defineProperty(c,a.Mixin.MIXIN_NAME_KEY,{value:Coral.Utils.getUID(),writable:!1,enumerable:!1,configurable:!1});var d=a.Mixin.MIXIN_KEY+c[a.Mixin.MIXIN_NAME_KEY];if(!(d in b)){var e=c.__mixin_dependencies;if(e)for(var f=0;f<e.length;++f)a.Mixin(b,e[f]);var g=Object.getOwnPropertyNames(c);for(f=0;f<g.length;++f){var h=g[f];if(h!=a.Mixin.MIXIN_NAME_KEY&&h!=a.Mixin.MIXIN_DEPENDENCIES_KEY){var i=Object.getOwnPropertyDescriptor(c,h);i.value==a.Mixin.VIRTUAL?h in b||Coral.Utils.error("virtual properties not implemented",b,c[a.Mixin.MIXIN_NAME_KEY]):h in b||Object.defineProperty(b,h,i)}}Object.defineProperty(b,d,{value:c,writable:!1,enumerable:!1,configurable:!1})}}function e(b,c,d){if(!a.Bindable.isBindable(b,c)||d){var e=a.Utils.findPropertyDefinition(b,c);if(d){var f=a.Bindable.DEPENDENCIES_KEY+c;Object.defineProperty(e,f,{value:d,writable:!1,enumerable:!1,configurable:!1})}else if(a.Utils.canWrapProperty(e,c)){var g=Object.getOwnPropertyDescriptor(e,c)||{value:void 0,writable:!0};g.enumerable=g.configurable=!1;var f=a.Bindable.BINDING_KEY+c;g.writable?a.Utils.wrapProperty(e,c,f,g,{get:function(){return this[f]},set:function(b){if(b!==this[f]){var d=this[f];this[f]=b,a.Bindable.trigger(this,c,this[f],d)}}}):Object.defineProperty(e,f,{value:!0,writable:!1,enumerable:!1,configurable:!1})}else Coral.Utils.warning("property cannot be made bindable",b,c)}}a.Extends=b,a.Class=c,a.Mixin=d,function(b){function c(b,c){return c.hasOwnProperty(a.Mixin.MIXIN_NAME_KEY)&&void 0!==b[a.Mixin.MIXIN_KEY+c[a.Mixin.MIXIN_NAME_KEY]]}b.MIXIN_KEY="__mixin_",b.MIXIN_NAME_KEY="__mixin_name",b.MIXIN_DEPENDENCIES_KEY="__mixin_dependencies",b.VIRTUAL=-4242,b.is=c}(a.Mixin||(a.Mixin={}));var d=a.Mixin;a.Bindable=e,function(b){function c(b,c){return a.Bindable.BINDING_KEY+c in b||d(b,c)}function d(b,c){return a.Bindable.DEPENDENCIES_KEY+c in b}function e(b,c){return b[a.Bindable.DEPENDENCIES_KEY+c]}function f(a,b,c,d){if(a.__bindings__&&a.__bindings__[b]){for(void 0!==a.__bindings__[b].counter&&Coral.Utils.error("avoid binding loop or use an asynchronous callback",a,b),c||(c=a[b]),a.__bindings__[b].count=a.__bindings__[b].length,a.__bindings__[b].counter=0;a.__bindings__[b].counter<a.__bindings__[b].count;++a.__bindings__[b].counter){var e=a.__bindings__[b][a.__bindings__[b].counter];e.l.handleChange(c,d,e.p)}a.__bindings__[b].counter=void 0}}function g(a,b){if(a.__bindings__){b=b||Object.keys(a.__bindings__);for(var c=0;c<b.length;++c){var d=b[c];if(a.__bindings__[d]){for(void 0!==a.__bindings__[d].counter&&Coral.Utils.error("avoid binding loop or use an asynchronous callback",a,d),a.__bindings__[d].count=a.__bindings__[d].length,a.__bindings__[d].counter=0;a.__bindings__[d].counter<a.__bindings__[d].count;++a.__bindings__[d].counter){var e=a.__bindings__[d][a.__bindings__[d].counter];e.l.handleChange(a[d],void 0,e.p)}a.__bindings__[d].counter=void 0}}}}function h(b,c,d,e){a.Mixin(d,a.Bindable.PropertyListenerMixin),a.Bindable.autoBindableEnable?a.Bindable(b,c):a.Bindable.isBindable(b,c)||Coral.Utils.warning("property is not bindable",b,c);var f={l:d,p:e};return b.__bindings__=b.__bindings__||{},b.__bindings__[c]=b.__bindings__[c]||[],b.__bindings__[c].push(f),f}function i(a,b,c){if(a.__bindings__&&a.__bindings__[b])for(var d=0;d<a.__bindings__[b].length;++d)if(a.__bindings__[b][d]===c){a.__bindings__[b].splice(d,1),void 0!==a.__bindings__[b].counter&&d<a.__bindings__[b].count&&(--a.__bindings__[b].count,a.__bindings__[b].counter=d<=a.__bindings__[b].counter?a.__bindings__[b].counter-1:a.__bindings__[b].counter);break}}b.BINDING_KEY="__binding_",b.DEPENDENCIES_KEY="__dependencies_",b.autoBindableEnable=!0,b.PropertyListenerMixin={__mixin_name:"PropertyListenerMixin",handleChange:a.Mixin.VIRTUAL},b.isBindable=c,b.hasDependencies=d,b.getDependencies=e,b.trigger=f,b.triggerAll=g,b.bind=h,b.unbind=i}(a.Bindable||(a.Bindable={}));var e=a.Bindable}(Meta||(Meta={}));var Coral;!function(a){var b=/(.*)\(\s*\)/,c=function(){function c(a,c){this.host=a,this.chain=c,this.properties=c.split("."),this.functions={};for(var d=0;d<this.properties.length;++d){var e=b.exec(this.properties[d]);e&&e.length>0&&(this.functions[d]=e[1])}this.watchers=[],this.result=void 0}return c.prototype.unbind=function(){if(this.binded){for(this.binded=!1;this.watchers.length>0;){var a=this.watchers.pop();if(a)if(Array.isArray(a))for(var b=0;b<a.length;++b)a[b].unbind();else Meta.Bindable.unbind(this.chainResults[this.watchers.length],this.properties[this.watchers.length],a)}this.chainResults=void 0,this.result=void 0}return this},c.prototype.createWatchers=function(b,c){var d=this.functions[c]||this.properties[c],e=Meta.Bindable.getDependencies(b,d);if(e){for(var f=[],g=0;g<e.length;++g){var h=e[g].split("@");1==h.length?f.push(new a.Watcher(b,h[0],this.watcherDependency,this,c).bind()):2==h.length&&f.push(new a.EventWatcher(b,h[0],h[1],this.eventWatcherDependency,this,c).bind())}this.watchers.push(f)}else this.functions[c]?this.watchers.push(void 0):this.watchers.push(Meta.Bindable.bind(b,d,this,c));var i=b[this.properties[c]];return this.functions[c]&&(i=b[this.functions[c]]()),this.chainResults[c+1]=i,i&&c+1<this.properties.length?this.createWatchers(i,c+1):i},c.prototype.eventWatcherDependency=function(a,b){var c=this.chainResults[b],d=this.chainResults[b+1],e=this.functions[b]?c[this.functions[b]]():c[this.properties[b]];d!==e&&(this.chainResults[b+1]=e,this.handleChange(e,d,b))},c.prototype.watcherDependency=function(a,b,c){var d=this.chainResults[c];b=this.chainResults[c+1],a=this.functions[c]?d[this.functions[c]]():d[this.properties[c]],b!==a&&(this.chainResults[c+1]=a,this.handleChange(a,b,c))},c.prototype.handleChange=function(){},c}();a.BindingBase=c}(Coral||(Coral={})),Meta.Mixin(Coral.BindingBase.prototype,Meta.Bindable.PropertyListenerMixin);var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Coral;!function(a){var b=function(a){function b(b,c,d,e,f){a.call(this,b,c),this.handler=d,this.context=e,this.params=f}return __extends(b,a),b.prototype.bind=function(a){return this.binded||(this.binded=!0,this.chainResults=[this.host],this.result=this.createWatchers(this.host,0),a&&this.handler.call(this.context,this.result,void 0,this.params)),this},b.prototype.handleChange=function(a,b,c){for(;this.watchers.length>c+1;){this.chainResults[this.watchers.length]=void 0;var d=this.watchers.pop();if(d)if(Array.isArray(d))for(var e=0;e<d.length;++e)d[e].unbind();else Meta.Bindable.unbind(this.chainResults[this.watchers.length],this.properties[this.watchers.length],d)}var f=this.result;this.chainResults[c+1]=a,this.result=a,a&&c+1<this.properties.length&&(this.result=this.createWatchers(a,c+1)),this.result!==f&&this.handler.call(this.context,this.result,f,this.params)},b}(a.BindingBase);a.Watcher=b}(Coral||(Coral={}));var Coral;!function(a){var b=function(a){function b(b,c,d,e){a.call(this,b,c),this.target=d,this.property=e}return __extends(b,a),b.prototype.bind=function(){return this.binded||(this.binded=!0,this.chainResults=[this.host],this.target[this.property]=this.createWatchers(this.host,0)),this},b.prototype.handleChange=function(a,b,c){for(;this.watchers.length>c+1;){this.chainResults[this.watchers.length]=void 0;var d=this.watchers.pop();if(d)if(Array.isArray(d))for(var e=0;e<d.length;++e)d[e].unbind();else Meta.Bindable.unbind(this.chainResults[this.watchers.length],this.properties[this.watchers.length],d)}this.chainResults[c+1]=a;var f=a;a&&c+1<this.properties.length&&(f=this.createWatchers(a,c+1)),this.target[this.property]=f},b}(a.BindingBase);a.Binding=b}(Coral||(Coral={}));var Coral;!function(a){var b=function(){function b(b,c,d,e,f,g){this.host=b,this.chain=c,this.event=d,this.handler=e,this.context=f,this.params=g,this.uid=a.Utils.getUID(),this.host=b,this.event=d,this.handler=e,this.context=f,this.params=g,c&&(this.watcher=new a.Watcher(b,c,this.resultChange,this))}return b.prototype.resultChange=function(b){this.result&&this.result.off([this.event,this.uid]),this.result=b,b&&(b instanceof a.EventDispatcher||a.Utils.error("object must be an instance of Coral.EventDispatcher",b),b.on([this.event,this.uid],this.handler,this.context,this.params))},b.prototype.bind=function(){return this.watcher?this.watcher.bind(!0):this.resultChange(this.host,void 0),this},b.prototype.unbind=function(){return this.watcher&&this.watcher.unbind(),this.result&&(this.result.off([this.event,this.uid]),this.result=void 0),this},b}();a.EventWatcher=b}(Coral||(Coral={}));var Coral;!function(a){var b=/([^{}]+|{([^{}]+)})/g,c=function(){function a(c){this.components=[];for(var d;d=b.exec(c);)d[2]?this.components.push({v:d[2],m:a.BINDING_COMPONENT}):this.components.push({v:d[1],m:a.STRING_COMPONENT})}return a.BINDING_COMPONENT=0,a.STRING_COMPONENT=1,a}();a.BindingComposition=c}(Coral||(Coral={}));var Coral;!function(a){var b=function(){function b(b,c,d,e){this.host=b,this.target=d,this.property=e,this.watchers=[],c instanceof a.BindingComposition||(c=new a.BindingComposition(c)),this.composition=c;for(var f=0;f<c.components.length;++f)c.components[f].m===a.BindingComposition.BINDING_COMPONENT&&(this.watchers[f]=new a.Watcher(b,c.components[f].v,this.handleChange,this))}return b.prototype.handleChange=function(){for(var a="",b=0;b<this.composition.components.length;++b)a+=this.watchers[b]?this.watchers[b].result:this.composition.components[b].v;this.target[this.property]=a},b.prototype.bind=function(){if(!this.binded){this.binded=!0;for(var a=0;a<this.watchers.length;++a)this.watchers[a]&&this.watchers[a].bind();this.handleChange()}return this},b.prototype.unbind=function(){if(this.binded){this.binded=!1;for(var a=0;a<this.watchers.length;++a)this.watchers[a]&&this.watchers[a].unbind()}return this},b}();a.CompositeBinding=b}(Coral||(Coral={}));var Coral;!function(a){var b=/^[^{}]+$/,c=/^{[^{}]+}$/,d=function(){function d(d,e,f,g){this.property=g,this.binding=b.test(e)?new a.Binding(d,e,this,"result"):c.test(e)?new a.Binding(d,e.substring(1,e.length-1),this,"result"):new a.CompositeBinding(d,new a.BindingComposition(e),this,"result"),this.node=f instanceof $?f:$(f)}return Object.defineProperty(d.prototype,"result",{get:function(){return this._result},set:function(a){var b=this._result;this._result=a,this.resultChange(a,b)},enumerable:!0,configurable:!0}),d.prototype.resultChange=function(){},d.prototype.bind=function(){return this.binding.bind(),this},d.prototype.unbind=function(){return this.binding.unbind(),this._result=void 0,this},d}();a.UIBinding=d;var e=function(a){function b(b,c,d,e){a.call(this,b,c,d,e)}return __extends(b,a),b.prototype.resultChange=function(a){a?this.node.attr(this.property,a):this.node.removeAttr(this.property)},b}(d);a.AttributeBinding=e;var f=function(a){function b(b,c,d,e){a.call(this,b,c,d,e)}return __extends(b,a),b.prototype.resultChange=function(a){this.node.css(this.property,a)},b}(d);a.StyleBinding=f;var g=function(a){function b(b,c,d,e){a.call(this,b,c,d),this.raw=e}return __extends(b,a),b.prototype.resultChange=function(a){this.raw?this.node.html(a):this.node.text(a)},b}(d);a.ContentBinding=g;var h=function(a){function b(b,c,d,e){a.call(this,b,c,d),this.className=e}return __extends(b,a),b.prototype.resultChange=function(a,b){a&&!b?this.node.addClass(this.className):!a&&b&&this.node.removeClass(this.className)},b}(d);a.ClassSwitchBinding=h;var i=function(a){function b(b,c,d){a.call(this,b,c,d)}return __extends(b,a),b.prototype.resultChange=function(a,b){b&&this.node.removeClass(b),a&&this.node.addClass(a)},b}(d);a.ClassBinding=i}(Coral||(Coral={}));var Coral;!function(a){var b=function(){function b(c){this.parentDispatcher=c,c&&(c instanceof b||a.Utils.error("object must be an instance of Coral.EventDispatcher",c))}return b.prototype.on=function(a,c,d,e,f){this._event_listeners=this._event_listeners||{};var g=Array.isArray(a)?a:a.split(b.EVENT_NAMESPACE_SEPARATOR);a=g[0];var h=g.length>1?g[1]:b.GLOBAL_EVENT_SPACE,i=this._event_listeners[h]=this._event_listeners[h]||{};return i[a]=i[a]||[],i[a].push({h:c,c:d,p:e,o:f}),this},b.prototype.one=function(a,b,c,d){return this.on(a,b,c,d,!0)},b.prototype.off=function(a){if(this._event_listeners){var c=a instanceof Array?a:a.split(b.EVENT_NAMESPACE_SEPARATOR),a=c[0],d=c.length>1?c[1]:b.GLOBAL_EVENT_SPACE,e=this._event_listeners[d]=this._event_listeners[d]||{};""==a?e=void 0:e[a]=void 0}return this},b.prototype.dispatch=function(b){b instanceof a.Event||a.Utils.error("dispatched event must be an instance of Coral.Event",b);var c=b.bubbles,d=!1;if(this._event_listeners){b.target?b.currentTarget=this:b.target=b.currentTarget=this;for(var e in this._event_listeners){var f=this._event_listeners[e];if(void 0!=f){var g=f[b.type];if(g)for(var h=0;!d&&h<g.length;++h){var i=g[h],j=i.h.call(i.c,b,i.p);(j===!1||b.isPropagationStopped()||b.isImmediatePropagationStopped())&&(c=!1),(j===!1||b.isImmediatePropagationStopped())&&(d=!0),i.o&&(g.splice(h,1),--h)}}}}return c&&!d&&this.parentDispatcher&&this.parentDispatcher.dispatch(b),this},b.GLOBAL_EVENT_SPACE="_g",b.EVENT_NAMESPACE_SEPARATOR=".",b}();a.EventDispatcher=b;var c=function(){function a(a,b,c){Object.defineProperty(this,"type",{writable:!1,value:a}),Object.defineProperty(this,"data",{writable:!1,value:b}),Object.defineProperty(this,"bubbles",{writable:!1,value:Boolean(c)}),this._stopPropagation=!1,this._stopImmediatePropagation=!1,this.target=void 0,this.currentTarget=void 0}return a.prototype.isImmediatePropagationStopped=function(){return Boolean(this._stopImmediatePropagation)},a.prototype.isPropagationStopped=function(){return Boolean(this._stopPropagation)||this.isImmediatePropagationStopped()},a.prototype.stopPropagation=function(){this._stopPropagation=!0},a.prototype.stopImmediatePropagation=function(){this._stopImmediatePropagation=!0},a}();a.Event=c}(Coral||(Coral={}));var Coral;!function(a){var b=function(b){function c(a){b.call(this,void 0),Object.defineProperty(this,"items",{writable:!1,value:a&&Array.isArray(a)?a:[]}),this.length=this.items.length}return __extends(c,b),c.prototype.add=function(b,d){if(d)for(var e=0;e<this.items.length;++e)if(this.items[e]===b)return;this.items.push(b),this.length+=1,this.dispatch(new a.Event(c.ADD_EVENT,{value:b,index:this.items.length-1}))},c.prototype.addAll=function(a,b){for(var c=0;c<a.length;++c)this.add(a[c],b)},c.prototype.insert=function(b,d,e){if(d>this.items.length)return this.add(b,e);if(e)for(var f=0;f<this.items.length;++f)if(this.items[f]===b)return;this.items.splice(d,0,b),this.length+=1,this.dispatch(new a.Event(c.ADD_EVENT,{value:b,index:d}))},c.prototype.remove=function(b,d){for(var e=0;e<this.items.length;++e)if(this.items[e]===b){if(this.items.splice(e,1),this.length-=1,this.dispatch(new a.Event(c.REMOVE_EVENT,{value:b,index:e})),!d)break;--e}},c.prototype.removeAll=function(a,b){for(var c=0;c<a.length;++c)this.remove(a[c],b)},c.prototype.move=function(b,d){var e=this.items[b];this.items.splice(b,1),this.items.splice(d,0,e),this.dispatch(new a.Event(c.MOVE_EVENT,{value:e,from:b,to:d}))},c.prototype.swap=function(a,b){var c=this.items[a];this.set(this.items[b],a),this.set(c,b)},c.prototype.get=function(a){return this.items[a]},c.prototype.set=function(b,d){var e=this.items[d];this.items[d]=b,this.length=this.items.length,this.dispatch(new a.Event(c.SET_EVENT,{value:b,oldValue:e,at:d}))},c.ADD_EVENT="add",c.REMOVE_EVENT="remove",c.MOVE_EVENT="move",c.SET_EVENT="set",c}(a.EventDispatcher);a.Collection=b}(Coral||(Coral={}));var Coral;!function(a){!function(a){function b(b){Meta.Mixin(b,a.UpdatableMixin),0==d.length&&(e=setTimeout(a.triggerUpdate,0)),d.push(b)}function c(){clearTimeout(e);var a=d;d=[];for(var b=0;b<a.length;++b)a[b].isUpToDate||a[b].update()}a.UpdatableMixin={__mixin_name:"UpdatableMixin",update:Meta.Mixin.VIRTUAL,isUpToDate:!1,planUpdate:function(){this.isUpToDate=!1,a.planUpdate(this)}};var d=[],e=void 0;a.planUpdate=b,a.triggerUpdate=c}(a.AsynchronousUpdater||(a.AsynchronousUpdater={})),a.AsynchronousUpdater}(Coral||(Coral={}));var Coral;!function(a){a.StateMixin={__mixin_name:"StateMixin",matchState:Meta.Mixin.VIRTUAL},a.STATE_CHANGE_EVENT="stateChange";var b=/([0-9a-zA-Z_\-]*).([0-9a-zA-Z_\-.]+)/,c=function(){function c(d){for(var e=d.split(":"),f=0;f<e.length;++f){var g=e[f];if(g){var h=b.exec(g);if(h){var i=h[1]||c.DEFAULT_STATE,j=h[2].split(".");this[i]=j}else a.Utils.error("the state expression is malformed",this,d)}}}return c.DEFAULT_STATE="__default",c}();a.StateMatching=c}(Coral||(Coral={}));var global=this,Coral;!function(a){var b=function(){function a(b,c){this.mode=c||a.SIMPLE_BINDING_MODE,this.chain=b}return a.simpleBindingExp=/^{[^{}]+}$/,a.compositeBindingExp=/{[^{}]+}/,a.SIMPLE_BINDING_MODE=1,a.COMPOSITE_BINDING_MODE=2,a}();a.Bind=b;var c=function(){function b(b){this.values=[];for(var c in b)"_"===c?this.values.push({v:b._}):this.values.unshift({v:b[c],s:new a.StateMatching(c)})}return b.prototype.resolve=function(b){Meta.Mixin(b,a.StateMixin);for(var c=0;c<this.values.length;++c){var d=this.values[c];if(d.s&&b.matchState(d.s)||!d.s)return d}return void 0},b}();a.BindState=c;var d=function(){function b(b,c){this.type=b,this.type=b,this.attributes=a.Utils.objectFilter(c,void 0,/^.*Event|.*Watcher$/),this.events=a.Utils.objectFilter(c,/^(.*)Event$/),this.watchers=a.Utils.objectFilter(c,/^(.*)Watcher$/),Object.defineProperty(this,"uid",{writable:!1,enumerable:!1,value:a.Utils.getUID()})}return b.instanciateAll=function(a,b,c,d,e){var f=[];d=d||0,e=e||a.length-1;for(var g=d;e>=g;++g)f.push(a[g].instanciate(b,c));return f},b.prototype.instanciate=function(b,c,d){var e;if(!this.type)throw"Malformed descriptor : type is missing";if(this.type instanceof Function)e=new this.type(this,b,c,d);else{var f=a.Utils.getChain(global,this.type);if(!(f instanceof Function))throw"'"+this.type+"' is not a constructor";e=new f(this,b,c,d)}return e},b}();a.Descriptor=d}(Coral||(Coral={}));var Coral;!function(a){var b=function(b){function c(c,d,e,f){b.call(this,e instanceof a.EventDispatcher?e:void 0),Object.defineProperty(this,"context",{writable:!1,value:d||global}),Object.defineProperty(this,"owner",{writable:!1,value:e}),Object.defineProperty(this,"uid",{writable:!1,value:a.Utils.getUID()}),Object.defineProperty(this,"_externalDescription",{writable:!1,enumerable:!1,value:c}),Object.defineProperty(this,"_descriptions",{writable:!1,enumerable:!1,configurable:!1,value:{attributes:{},events:{},watchers:{}}}),this.item=f,this.triggerDescriptions(),this.context&&this.id&&(this.context[this.id]=this),Meta.Mixin.is(this,a.StateMixin)&&this.on([a.STATE_CHANGE_EVENT,this.uid],this.triggerInternalDescriptions,this),this._externalDescription&&Meta.Mixin.is(this.context,a.StateMixin)&&this.context instanceof a.EventDispatcher&&this.context.on([a.STATE_CHANGE_EVENT,this.uid],this.triggerExternalDescription,this)}return __extends(c,b),c.prototype.triggerDescriptions=function(){this.triggerInternalDescriptionsEventsAndWatchers(this,0,!0),this._externalDescription&&this.triggerDescriptionEventsAndWatchers(this._externalDescription,this.context,1,!0),this._externalDescription&&this.triggerDescriptionProperties(this._externalDescription,this.context,1,!0),this.triggerInternalDescriptionsProperties(this,0,!0)},c.prototype.triggerInternalDescriptions=function(){this.triggerInternalDescriptionsEventsAndWatchers(this,0),this.triggerInternalDescriptionsProperties(this,0)},c.prototype.triggerExternalDescription=function(){this._externalDescription&&(this.triggerDescriptionEventsAndWatchers(this._externalDescription,this.context,1),this.triggerDescriptionProperties(this._externalDescription,this.context,1))},c.prototype.triggerInternalDescriptionsEventsAndWatchers=function(a,b,c){var d=Object.getPrototypeOf(a);d&&this.triggerInternalDescriptionsEventsAndWatchers(d,b-1,c),a.hasOwnProperty("description")&&this.triggerDescriptionEventsAndWatchers(a.description,this,b,c)},c.prototype.triggerInternalDescriptionsProperties=function(a,b,c){var d=Object.getPrototypeOf(a);a.hasOwnProperty("description")&&this.triggerDescriptionProperties(a.description,this,b,c),d&&this.triggerInternalDescriptionsProperties(d,b-1,c)},c.prototype.triggerDescriptionEventsAndWatchers=function(b,c,d,e){var f=this._descriptions.events[d]=this._descriptions.events[d]||{};for(var g in b.events){var h=b.events[g];if(h instanceof a.BindState){h=h.resolve(c);var i=f[g];if(i===h)continue;i&&this.off([g,b.uid]),h&&this.on([g,b.uid],c[h.v],c),f[g]=h}else e&&this.on([g,b.uid],c[h],c)}var j=this._descriptions.watchers[d]=this._descriptions.watchers[d]||{};for(var g in b.watchers){var h=b.watchers[g];if(h instanceof a.BindState){h=h.resolve(c);var i=j[g];if(i&&i.r===h)continue;if(i&&i.i.unbind(),h){var k=new a.Watcher(this,g,c[h.v],c).bind();j[g]={r:h,i:k}}else j[g]=void 0}else if(e){var k=new a.Watcher(this,g,c[h],c).bind();j[g]={i:k}}}},c.prototype.triggerDescriptionProperties=function(b,c,d,e){var f=this._descriptions.attributes;for(var g in b.attributes){var h=f[g];if(!(h&&h.d>d)){var i=b.attributes[g];if(i instanceof a.BindState)if(i=i.resolve(c)){if(h&&h.r===i)continue;if(h&&h.i&&h.i.unbind(),i.v instanceof a.Bind){if(i.v.mode==a.Bind.SIMPLE_BINDING_MODE)var j=new a.Binding(c,i.v.chain,this,g).bind();else var j=new a.CompositeBinding(c,new a.BindingComposition(i.v.chain),this,g).bind();f[g]={d:d,r:i,i:j}}else this[g]=i.v,f[g]={d:d,r:i}}else f[g]=void 0,this[g]=Object.getPrototypeOf(this)[g];else if(e)if(i instanceof a.Bind){if(i.mode==a.Bind.SIMPLE_BINDING_MODE)var j=new a.Binding(c,i.chain,this,g).bind();else var j=new a.CompositeBinding(c,new a.BindingComposition(i.chain),this,g).bind();f[g]={d:d,i:j}}else this[g]=i,f[g]={d:d}}}},c.prototype.isExternal=function(a){return void 0!=this._descriptions.attributes[a]&&1==this._descriptions.attributes[a].d},c.prototype.update=function(){this.isUpToDate=!0},c.prototype.destroy=function(){this.context instanceof a.EventDispatcher&&this.context.off([a.STATE_CHANGE_EVENT,this.uid]);for(var b in this._descriptions.watchers){var c=this._descriptions.watchers[b];for(var d in c){var e=c[d];e&&e.i&&e.i.unbind()}}var c=this._descriptions.attributes;for(var d in c){var e=c[d];e&&e.i&&e.i.unbind()}this.context&&this.id&&(this.context[this.id]=void 0)},c}(a.EventDispatcher);a.DescribableObject=b,Meta.Bindable(b.prototype,"item"),Meta.Mixin(b.prototype,a.AsynchronousUpdater.UpdatableMixin),Object.defineProperties(b.prototype,{global:{writable:!1,configurable:!1,value:global},self:{configurable:!1,get:function(){return this}}})}(Coral||(Coral={}));var Coral;!function(a){var b=function(b){function c(a,c,d,e){b.call(this,a,c,d,e)}return __extends(c,b),c.prototype.run=function(){if(this.running)throw"Task ["+this.constructor.name+"] "+this.uid+" is already running";this.dispatch(new a.Event(c.RUN_EVENT)),this.canceled=!1,this.running=!0,this.do()},c.prototype.do=function(){},c.prototype.cancel=function(){this.running&&(this.canceled=!0,this.running=!1,this.dispatch(new a.Event(c.CANCEL_EVENT)))},c.prototype.done=function(){this.running=!1,this.dispatch(new a.Event(c.DONE_EVENT))},c.RUN_EVENT="run",c.DONE_EVENT="done",c.CANCEL_EVENT="cancel",c}(a.DescribableObject);a.Task=b,b.prototype.canceled=!1,b.prototype.running=!1,b.prototype.critical=!0;var c=function(c){function d(a,b,d,e){c.call(this,a,b,d,e)}return __extends(d,c),d.prototype.do=function(){!this.tasksInitialized&&this.tasks&&(this._tasks=a.Descriptor.instanciateAll(this.tasks,this.isExternal("tasks")?this.context:this,this),this.tasksInitialized=!0),this.taskIndex=-1,this.runNext()},d.prototype.cancel=function(){c.prototype.cancel.call(this),this.running&&this._tasks&&this.taskIndex<this._tasks.length&&(this._tasks[this.taskIndex].off([b.DONE_EVENT,this.uid]),this._tasks[this.taskIndex].off([b.CANCEL_EVENT,this.uid]),this._tasks[this.taskIndex].cancel())},d.prototype.subTaskCanceled=function(a){a.target.critical?this.cancel():this.runNext()},d.prototype.runNext=function(){if(this.taskIndex>=0&&(this._tasks[this.taskIndex].off([b.DONE_EVENT,this.uid]),this._tasks[this.taskIndex].off([b.CANCEL_EVENT,this.uid])),!this.canceled)if(++this.taskIndex,!this._tasks||this._tasks.length<=this.taskIndex)this.done();else{var a=this._tasks[this.taskIndex];a.on([b.DONE_EVENT,this.uid],this.runNext,this),a.on([b.CANCEL_EVENT,this.uid],this.subTaskCanceled,this),a.run()}},d.prototype.destroy=function(){if(c.prototype.destroy.call(this),this._tasks)for(var a=0;a<this._tasks.length;++a)this._tasks[a].destroy()},d}(b);a.SequentialTasks=c;var d=function(c){function d(a,b,d,e){c.call(this,a,b,d,e)}return __extends(d,c),d.prototype.do=function(){if(!this.tasksInitialized&&this.tasks&&(this._tasks=a.Descriptor.instanciateAll(this.tasks,this.isExternal("tasks")?this.context:this,this),this.tasksInitialized=!0),this._tasks&&0!=this._tasks.length){this.taskCount=0;for(var c=0;c<this._tasks.length&&!this.canceled;++c){var d=this._tasks[c];d.on([b.DONE_EVENT,this.uid],this.partialDone,this),d.on([b.CANCEL_EVENT,this.uid],this.subTaskCanceled,this),this._tasks[c].run()}}else this.done()},d.prototype.cancel=function(){if(c.prototype.cancel.call(this),this._tasks)for(var a=0;a<this._tasks.length;++a)this._tasks[a].off([b.DONE_EVENT,this.uid]),this._tasks[a].off([b.CANCEL_EVENT,this.uid]),this._tasks[a].cancel()},d.prototype.subTaskCanceled=function(a){a.target.critical?this.cancel():this.partialDone()},d.prototype.partialDone=function(){if(!this.canceled&&(++this.taskCount,this.taskCount>=this._tasks.length)){for(var a=0;a<this._tasks.length;++a)this._tasks[a].off([b.DONE_EVENT,this.uid]),this._tasks[a].off([b.CANCEL_EVENT,this.uid]);this.done()}},d.prototype.destroy=function(){if(c.prototype.destroy.call(this),this._tasks)for(var a=0;a<this._tasks.length;++a)this._tasks[a].destroy()},d}(b);a.ParallelTasks=d}(Coral||(Coral={}));var Coral;!function(a){var b=function(b){function c(a,c,d,e){b.call(this,a,c,d,e),this.from=this.from||0}return __extends(c,b),Object.defineProperty(c.prototype,"descriptors",{get:function(){return this._descriptors},set:function(a){this._descriptors!=a&&(this._descriptors=Array.isArray(a)?a:[a],this.to=this.to||this._descriptors.length,this.to=this.to>this._descriptors.length?this._descriptors.length:this.to,this.from=this.from>this._descriptors.length?0:this.from,this._descriptorsUpToDate=!1,this.planUpdate())},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"from",{get:function(){return this._from},set:function(a){this._from!=a&&(this._from=a,this._rangeUpToDate=!1,this.planUpdate())},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"to",{get:function(){return this._to},set:function(a){this._to!=a&&(this._to=a,this._rangeUpToDate=!1,this.planUpdate())},enumerable:!0,configurable:!0}),c.prototype.update=function(){b.prototype.update.call(this);var c=this.external?this.owner.context:this.owner;if(this.descriptors){if(!this._descriptorsUpToDate){if(Meta.Mixin.is(c,a.StateMixin)&&c instanceof a.EventDispatcher&&c.off([a.STATE_CHANGE_EVENT,this.uid]),this._rangeUpToDate=!1,this.instances)for(var d=0;d<this.instances.length;++d)this.deactivateInstance(d);this.instances=[];for(var d=0;d<this.descriptors.length;++d){var e=this.descriptors[d],f={descriptor:e};this.instances.push(f),e.attributes.include?f.watcher=new a.Watcher(c,e.attributes.include,this.includeChange,this,d):Meta.Mixin.is(c,a.StateMixin)&&(e.attributes.includeIn?(this.dependsOnOwnerState=!0,f.includeIn=new a.StateMatching(e.attributes.includeIn)):e.attributes.excludeFrom&&(this.dependsOnOwnerState=!0,f.excludeFrom=new a.StateMatching(e.attributes.excludeFrom)))}this.dependsOnOwnerState&&c.on([a.STATE_CHANGE_EVENT,this.uid],this.stateChange,this)}if(!this._rangeUpToDate){if(this._descriptorsUpToDate){for(var d=0;d<this.from;++d)this.deactivateInstance(d);for(d=this.to;d<this.instances.length;++d)this.deactivateInstance(d)
}for(this._descriptorsUpToDate=!0,this._rangeUpToDate=!0,d=this.from;d<this.to;++d)this.checkInstance(d)}}},c.prototype.checkInstance=function(a){if(!(a<this.from||a>=this.to)){var b=this.external?this.owner.context:this.owner,c=this.instances[a];c.watcher?(c.isActive||c.watcher.bind(),c.watcher.result?this.activateInstance(a):this.deactivateInstance(a)):c.includeIn?b.matchState(c.includeIn)?this.activateInstance(a):this.deactivateInstance(a):c.excludeFrom?b.matchState(c.excludeFrom)?this.deactivateInstance(a):this.activateInstance(a):this.activateInstance(a)}},c.prototype.activateInstance=function(a){var b=this.instances[a];b.isActive||(b.instance||(b.instance=b.descriptor.instanciate(this.external?this.owner.context:this.owner,this.owner)),this.collection.insert(b.instance,this.calculateCollectionIndex(a)),b.isActive=!0)},c.prototype.deactivateInstance=function(a){var b=this.instances[a];b.watcher&&b.watcher.unbind(),b.instance&&(this.collection.remove(b.instance),b.instance.cache||(b.instance.destroy(),b.instance=void 0)),b.isActive=!1},c.prototype.includeChange=function(a,b,c){this.checkInstance(c)},c.prototype.stateChange=function(){for(var a=this.from;a<this.to;++a){var b=this.instances[a];(b.includeIn||b.excludeFrom)&&this.checkInstance(a)}},c.prototype.calculateCollectionIndex=function(a){for(var b=0,c=this.from;a>c;++c)this.instances[c].isActive&&++b;return b},c.prototype.parseIncludeProperty=function(a){for(var b=a.split(":"),c=[],d=0;d<b.length;++d)b[d]&&""!=b[d]&&c.push(b[d].split("."));return c},c.prototype.destroy=function(){b.prototype.destroy.call(this);for(var c=0;c<this.instances.length;++c)this.instances[c].watcher&&this.instances[c].watcher.unbind();for(;this.collection.length>0;){var d=this.collection.get(0);this.collection.remove(d),d.destroy()}var e=this.external?this.owner.context:this.owner;e.off([a.STATE_CHANGE_EVENT,this.uid])},c}(a.DescribableObject);a.DescriptorsFactory=b}(Coral||(Coral={}));var Coral;!function(a){var b=function(b){function c(a,c,d,e){b.call(this,a,c,d,e)}return __extends(c,b),Object.defineProperty(c.prototype,"items",{get:function(){return this._items},set:function(b){this._items!=b&&(this._items&&this._items instanceof a.Collection&&(this._items.off([a.Collection.ADD_EVENT,this.uid]),this._items.off([a.Collection.REMOVE_EVENT,this.uid]),this._items.off([a.Collection.MOVE_EVENT,this.uid]),this._items.off([a.Collection.SET_EVENT,this.uid])),this._items=b,this._itemsUpToDate=!1,this._items&&this._items instanceof a.Collection&&(this.items.on([a.Collection.ADD_EVENT,this.uid],this.addHandler,this),this.items.on([a.Collection.REMOVE_EVENT,this.uid],this.removeHandler,this),this.items.on([a.Collection.MOVE_EVENT,this.uid],this.moveHandler,this),this.items.on([a.Collection.SET_EVENT,this.uid],this.setHandler,this)),this.planUpdate())},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"itemDescriptor",{get:function(){return this._itemDescriptor},set:function(a){this._itemDescriptor!=a&&(this._itemDescriptor=a,this._itemDescriptorUpToDate=!1,this.planUpdate())},enumerable:!0,configurable:!0}),c.prototype.addHandler=function(a){var b=this.itemDescriptor.instanciate(this.external?this.owner.context:this.owner,this.owner,a.data.value);a.data.index?this.collection.insert(b,a.data.index):this.collection.add(b)},c.prototype.removeHandler=function(a){this.collection.get(a.data.index).destroy(),this.collection.remove(this.collection.get(a.data.index))},c.prototype.moveHandler=function(a){this.collection.move(a.data.from,a.data.to)},c.prototype.setHandler=function(a){this.collection.get(a.data.at).destroy();var b=this.itemDescriptor.instanciate(this.external?this.owner.context:this.owner,this.owner,a.data.value);this.collection.set(b,a.data.at)},c.prototype.update=function(){if(b.prototype.update.call(this),!this._itemDescriptorUpToDate)for(this._itemDescriptorUpToDate=!0;this.collection.length>0;){var a=this.collection.get(0);this.collection.remove(a),a.destroy()}if(!this._itemsUpToDate){this._itemsUpToDate=!0;var c=this.external?this.owner.context:this.owner;if(this.items)for(var d=0;d<this.items.length;++d){var e=void 0;if(this.collection.length>d&&this.collection.get(d).item==this.items.get(d))e=this.collection[d];else for(var f=d+1;f<this.collection.length;++f)this.collection.get(f).item===this.items.get(d)&&(e=this.collection.get(f),this.collection.swap(f,d));e||(e=this.itemDescriptor.instanciate(c,this.owner,this.items.get(d)),this.collection.insert(e,d))}if(this.items)for(var d=this.items.length;d<this.collection.length;)this.collection.get(d).destroy(),this.collection.remove(this.collection.get(d))}},c.prototype.destroy=function(){for(b.prototype.destroy.call(this);this.collection.length>0;){var c=this.collection.get(0);this.collection.remove(c),c.destroy()}this._items&&this._items instanceof a.Collection&&(this._items.off([a.Collection.ADD_EVENT,this.uid]),this._items.off([a.Collection.REMOVE_EVENT,this.uid]),this._items.off([a.Collection.MOVE_EVENT,this.uid]),this._items.off([a.Collection.SET_EVENT,this.uid]))},c}(a.DescribableObject);a.DataDescriptorsFactory=b}(Coral||(Coral={}));var Coral;!function(a){var b=function(b){function c(c,d,e,f){b.call(this,c,d,e,f),this.owner instanceof a.EventDispatcher||a.Utils.error("owner of an ActionMap must be an instance of EventDispatcher",this),this.actions&&(this._actions=a.Descriptor.instanciateAll(this.actions,this.isExternal("actions")?this.context:this,this))}return __extends(c,b),c.prototype.destroy=function(){if(b.prototype.destroy.call(this),this._actions)for(var a=0;a<this._actions.length;++a)this._actions[a].destroy()},c}(a.DescribableObject);a.ActionMap=b;var c=function(c){function d(d,e,f,g){c.call(this,d,e,f,g),this.event||a.Utils.error("'event' is mandatory on Action",this),this.owner instanceof b||a.Utils.error("owner of an Action must be an instance of ActionMap",this),this.owner.owner.on([this.event,this.uid],function(a){this.currentEvent=a,this.run()},this)}return __extends(d,c),d.prototype.done=function(){c.prototype.done.call(this),this.currentEvent=void 0},d.prototype.cancel=function(){c.prototype.cancel.call(this),this.currentEvent=void 0},d.prototype.destroy=function(){c.prototype.destroy.call(this),this.owner.owner.off([this.event,this.uid])},d}(a.SequentialTasks);a.Action=c}(Coral||(Coral={}));var Coral;!function(a){var b=/^[/]*(.*[^/])[/]*$/,c=function(c){function d(b,e,f){return this.mode=d.HISTORY_MODE,d.instance?d.instance:(c.call(this,b,e,f),d.instance=this,this.actions&&(this._actions=a.Descriptor.instanciateAll(this.actions,this.isExternal("actions")?this.context:this,this)),window&&this.mode==d.HISTORY_MODE&&$(window).on("popstate.NavigationMap",this._handlePopState.bind(this)),history&&this.mode==d.HISTORY_MODE&&(this.historyState=history.state),void 0)}return __extends(d,c),d.prototype._handlePopState=function(a){this.historyState=a.state,this._calculateSubPath(window.location.pathname),this.triggerActions()},d.normalize=function(a){if(""==a||!a)return"/";var c=b.exec(a);if(c)return"/"+c[1];throw"error"},d.prototype._calculateSubPath=function(a){var b=a.lastIndexOf(this._rootPath);if(0!=b)throw"error";var c=a.substring(this._rootPath.length,a.length);this._subPath=d.normalize(c),this.currentPath=this._rootPath+this._subPath},d.prototype._calculatePath=function(a){this._subPath=d.normalize(a),this.currentPath=this._rootPath+this._subPath},d.prototype.start=function(a,b,c){this._rootPath=d.normalize(a),this._calculateSubPath(d.normalize(c||window.location.pathname)),b||this.triggerActions()},d.prototype.navigate=function(a,b,c){this._calculatePath(a),history&&this.mode==d.HISTORY_MODE&&(b?history.replaceState(c,"",this.currentPath):history.pushState(c,"",this.currentPath)),this.triggerActions()},d.prototype.triggerActions=function(){if(this._actions)for(var a=0;a<this._actions.length;++a){var b=this._actions[a];b.applyPath(this._subPath)}},d.prototype.destroy=function(){if(c.prototype.destroy.call(this),window&&$(window).off("popstate.NavigationMap"),this._actions)for(var a=0;a<this._actions.length;++a)this._actions[a].destroy();d.instance=void 0},d.instance=void 0,d.NONE_MODE=1,d.HISTORY_MODE=2,d}(a.DescribableObject);a.NavigationMap=c;var d=/([^{}]+|{([^{}]+)})/g,e=function(b){function e(e,f,g){b.call(this,e,f,g,void 0),this.path||a.Utils.error("'path' is mandatory on NavigationAction",this),this.owner instanceof c||a.Utils.error("owner of an NavigationAction must be an instance of NavigationMap",this),this._path=c.normalize(this.path);for(var h,i="",j=[];h=d.exec(this._path);)h[2]?(i+="(.*)",j.push(h[2])):i+=h[1];this._pathExpression=new RegExp("^"+i+"$"),this._names=j}return __extends(e,b),e.prototype.applyPath=function(a){var b=this._pathExpression.exec(a);if(b){for(var c=0;c<this._names.length;++c)this.params={},this.params[this._names[c]]=b[c+1];return this.run(),!0}return!1},e}(a.SequentialTasks);a.NavigationAction=e}(Coral||(Coral={}));var Coral;!function(a){var b=function(a){function b(b,c,d){this.apply=!1,a.call(this,b,c,d)}return __extends(b,a),b.prototype.run=function(){a.prototype.run.call(this),this.target&&this.method&&(this.params?this.apply?this.target[this.method].apply(this.target,this.params):this.target[this.method].call(this.target,this.params):this.target[this.method]()),this.done()},b}(a.Task);a.MethodTask=b}(Coral||(Coral={}));var Coral;!function(a){var b=function(a){function b(b,c,d){a.call(this,b,c,d)}return __extends(b,a),b.prototype.run=function(){a.prototype.run.call(this),this.target&&this.property&&(this.target[this.property]=this.value),this.done()},b}(a.Task);a.SetTask=b}(Coral||(Coral={}));var Meta;!function(a){function b(b,c,d,e){if(Object.defineProperty(b,a.Model.MODEL_NAME_KEY,{value:c,writable:!1,enumerable:!1,configurable:!1}),Object.defineProperty(b,a.Model.MODEL_PRIMARY_KEY,{value:d,writable:!1,enumerable:!1,configurable:!1}),Object.defineProperty(b,a.Model.MODEL_KEYS_KEY,{value:e,writable:!1,enumerable:!1,configurable:!1}),a.Model.Store._createStore(c),Object.defineProperty(b,d,{get:function(){return this.__model?this.__model[d]:void 0}}),e)for(var f=0;f<e.length;++f){var g=e[f];a.Model.ModelAttribute(b,g)}}a.Model=b,function(b){function c(b,c){var d=a.Utils.findPropertyDefinition(b,c),e=Object.getOwnPropertyDescriptor(d,c);e?Coral.Utils.error("property cannot be a Model property because the property already exist",b,c):Object.defineProperty(b,c,{get:function(){return this.__model?this.__model[c]:void 0},set:function(b){this.hasOwnProperty(a.Model.MODEL_KEY)||(this.__model={}),this.__model[c]=b,this.__model_dirty=!0},enumerable:e?e.enumerable:!0})}function d(a){return a.__model_name}function e(a){return a.__model_primary}function f(a){return a.__model_keys}function g(b){return b.__model?b.__model[a.Model.getPrimaryKey(b)]:void 0}function h(a){return!!a.__model_dirty}function i(a){a.__model_dirty=!1}function j(a){return a.__model}function k(b,c,d){b.__model=c,b.__model_dirty=!1,d||a.Bindable.triggerAll(b,a.Model.getKeys(b))}b.MODEL_NAME_KEY="__model_name",b.MODEL_KEYS_KEY="__model_keys",b.MODEL_PRIMARY_KEY="__model_primary",b.MODEL_KEY="__model",b.MODEL_DIRTY_KEY="__model_dirty",b.ModelAttribute=c,b.getModelName=d,b.getPrimaryKey=e,b.getKeys=f,b.getPrimaryValue=g,b.isDirty=h,b.clean=i,b.getModelData=j,b.setModelData=k,function(b){function c(a){this._stores[a]=this._stores[a]||{}}function d(b,c){var d=b instanceof Function?b.prototype:b,e=c[a.Model.getPrimaryKey(d)];if(e){var f=this.modelByKey(b,e);if(f)return a.Model.setModelData(f,c),f;var g=b instanceof Function?new b:Object.create(b);return a.Model.setModelData(g,c,!0),this.registerModel(g),g}return void 0}function e(a,b){for(var c=[],d=0;d<b.length;++d)c.push(this.getModel(a,b[d]));return c}function f(b){var c=a.Model.getModelName(b),d=a.Model.getPrimaryValue(b);if(c&&d){var e=this._stores[c];return e[d]=b,!0}return!1}function g(b,c){var d=b instanceof Function?b.prototype:b,e=a.Model.getModelName(d);if(e){var f=this._stores[e];return f[c]}return void 0}function h(a){if(a)this._stores[a]={};else for(var a in this._stores)this._stores[a]={}}b._stores={},b._createStore=c,b.getModel=d,b.getModels=e,b.registerModel=f,b.modelByKey=g,b.clear=h}(b.Store||(b.Store={})),b.Store}(a.Model||(a.Model={}));var b=a.Model}(Meta||(Meta={}));var Meta;!function(a){function b(b,c,d){d=d||c,Object.defineProperty(b,c,{get:function(){var a=this.$el;return a?a.css(d):this.__explicit_style?this.__explicit_style[d]:void 0},set:function(b){this.hasOwnProperty(a.StyleProperty.EXPLICIT_STYLE_KEY)||(this.__explicit_style={}),this.__explicit_style[d]=b;var c=this.$el;c&&c.css(d,b)}})}a.StyleProperty=b,function(a){function b(a){var b=a.$el;b&&a.__explicit_style&&b.css(a.__explicit_style)}a.EXPLICIT_STYLE_KEY="__explicit_style",a.applyExplicitStyles=b}(a.StyleProperty||(a.StyleProperty={}));var b=a.StyleProperty}(Meta||(Meta={}));var Coral;!function(a){var b=/(^\s+|\s+$)/g,c=function(c){function d(b,e,f,g){if(c.call(this,b,e,f,g),this.dispatch(new a.Event(d.INIT_EVENT)),this.states&&!this.isExternal("states")){this._statesMap={},this._states=a.Descriptor.instanciateAll(a.Utils.prototypalMerge(this,"states"),this,this);for(var h=0;h<this._states.length;++h)this._registerState(this._states[h])}this.defs&&!this.isExternal("defs")&&(this._defs=a.Descriptor.instanciateAll(a.Utils.prototypalMerge(this,"defs"),this,this)),this.buildSkin(),this.applyDirectives(),this.dispatch(new a.Event(d.COMPLETE_EVENT))}return __extends(d,c),d.prototype.render=function(){},d.prototype.matchState=function(b){if(!b)return!0;var c=!0;for(var d in b){var e=b[d];if(this._statesMap)d==a.StateMatching.DEFAULT_STATE?c=this._defaultState.matchState(e):this._statesMap[d]&&(c=this._statesMap[d].matchState(e));else{for(var f=0;f<e.length&&"none"!=e[f];++f);c="none"==e[f]}if(!c)break}return c},d.prototype._registerState=function(b){b.name in this._statesMap&&a.Utils.error("State name already used",this,b.name),this._statesMap[b.name]=b,this._defaultState||(this._defaultState=b),b.on([a.State.CHANGE_EVENT,this.uid],this._stateChangeHandler,this)},d.prototype._stateChangeHandler=function(b){var c=new a.Event(a.STATE_CHANGE_EVENT,{stateName:b.data.stateName,oldValue:b.data.oldValue,newValue:b.data.newValue});this.dispatch(c)},d.prototype.getState=function(a){return a=a||"state",this._statesMap[a]},d.prototype.buildSkin=function(){if(this.$el&&this.$el instanceof $&&(this.el=this.$el.length>0?this.$el[0]:void 0),!this.el&&void 0!=this.skin&&this.skin instanceof $&&this.skin.length>0)this.el=this.skin[0].cloneNode(!0);else if(this.el||void 0==this.skin||"string"!=typeof this.skin)this.el||void 0==this.skin?this.el||(this.el=document.createElement("DIV")):this.el=this.skin.cloneNode(!0);else{var c=this.skin.replace(b,""),e=$(d.skinDiv).html(c);e[0].childNodes.length>0&&(this.el=e[0].childNodes[0],e.empty())}if(this.$el=$(this.el),this.id&&this.$el.attr("id",this.id),this.$el.attr("data-component",this.constructor.name),Meta.StyleProperty.applyExplicitStyles(this),this._states)for(var f=0;f<this._states.length;++f){var g=this._states[f];new a.ClassBinding(g,"css",this.$el).bind()}this.render()},d.prototype.applyDirectives=function(){this.clearDirectives();var a=function(b){if(b.attributes)for(var c=0;c<b.attributes.length;++c){var d=b.attributes[c];for(var e in this.directives){var f=this.directives[e],g=f.regexp.exec(d.name);g&&f.run.call(this,g,b,d.value)}}for(var c=0;c<b.children.length;++c){var h=b.children[c];h.hasAttribute("data-component")||a.call(this,h)}};a.call(this,this.el)},d.prototype.clearDirectives=function(){for(this._directive_binding=this._directive_binding||[],this._directive_attach=this._directive_attach||[],this._directive_action=this._directive_action||[],this._directive_container=!1;this._directive_binding.length>0;)this._directive_binding.pop().unbind();for(;this._directive_attach.length>0;)this.detachComponent(this._directive_attach.pop());for(;this._directive_action.length>0;){var a=this._directive_action.pop();this.removeDomEvent(a.node,a.type,a.namespace)}},d.prototype.findTarget=function(a,b){if(b=b||this.el,$(b).attr("data-container")==a)return b;for(var c=0;c<b.children.length;++c){var d=b.children[c];if(!$(d).attr("data-component")){var e=this.findTarget(a,d);if(e)return e}}return void 0},d.prototype.attachComponent=function(b,c,e){if(b.isAddedToDisplay)throw"child is already displayed";if(this._attachedComponents=this._attachedComponents||[],e=e||this.$el,!(e instanceof $))throw"Error : this kind of target is not managed ";b.parent=this,b.$container=e;var f=b.$container.children();c>=0&&f.length>c?$(f[c]).before(b.el):b.$container.append(b.el),this._attachedComponents.push(b),this.dispatch(new a.Event(d.ATTACH_COMPONENT_EVENT,{component:b})),this.isAddedToDisplay&&b.addedToDisplay()},d.prototype.detachComponent=function(b){if(this._attachedComponents)for(var c=0;c<this._attachedComponents.length;++c)if(this._attachedComponents[c]===b){this._attachedComponents.splice(c,1);break}b.$el&&b.$el.remove(),b.parent=b.$container=void 0,this.dispatch(new a.Event(d.DETACH_COMPONENT_EVENT,{component:b})),this.isAddedToDisplay&&b.removedFromDisplay()},d.prototype.addedToDisplay=function(){if(!this.isAddedToDisplay){this.isAddedToDisplay=!0;var b=this._domevents;if(b)for(var c=0;c<b.length;++c){var e=b[c];this.applyDomEvent(e)}if(this.dispatch(new a.Event(d.ADDED_TO_DISPLAY_EVENT)),this._attachedComponents)for(var c=0;c<this._attachedComponents.length;++c)this._attachedComponents[c].addedToDisplay()}},d.prototype.removedFromDisplay=function(){if(this.isAddedToDisplay){this.isAddedToDisplay=!1;var b=this._domevents;if(b)for(var c=0;c<b.length;++c){var e=b[c];this.unapplyDomEvent(e)}if(this.dispatch(new a.Event(d.REMOVED_FROM_DISPLAY_EVENT)),this._attachedComponents)for(var c=0;c<this._attachedComponents.length;++c)this._attachedComponents[c].removedFromDisplay()}},d.prototype.destroy=function(){if(c.prototype.destroy.call(this),this.context[this.id]=void 0,this._states)for(var a=0;a<this._states.length;++a)this._states[a].destroy();if(this.clearDirectives(),this._attachedComponents)for(var a=0;a<this._attachedComponents.length;++a)this._attachedComponents[a].destroy()},d.prototype.addDomEvent=function(a,b,c,d){var e=this._domevents=this._domevents||[],f={node:a,type:b,namespace:c,handler:d};return e.push(f),this.isAddedToDisplay&&this.applyDomEvent(f),f},d.prototype.applyDomEvent=function(a){var b=a.namespace?a.type+"."+a.namespace:a.type;a.node?$(a.node).on(b,void 0,{component:this},a.handler):this.$el.on(b,void 0,{component:this},a.handler)},d.prototype.unapplyDomEvent=function(a){var b=a.namespace?a.type+"."+a.namespace:a.type;a.node?$(a.node).off(b):this.$el.off(b)},d.prototype.removeDomEvent=function(a,b,c){a=a||this.el;var d=this._domevents;if(d)for(var e=0;e<d.length;++e){var f=d[e];f.node!=a&&(f.node||a!=this.el)||f.type!=b||f.namespace!=c||(this.unapplyDomEvent(f),d.splice(e,1),--e)}},d.prototype.on=function(b,e,f,g,h){var i=Array.isArray(b)?b:b.split(a.EventDispatcher.EVENT_NAMESPACE_SEPARATOR),j=i[0],k=i.length>1?i[1]:void 0;if(j in d.domEvents){var l=this;this.addDomEvent(void 0,j,k,function(a){e.call(f,a,g),h&&l.removeDomEvent(void 0,j,k)})}else if(j in d.computedEvents){for(var m,n=d.computedEvents[j],o=this.__computed_event_delegate=this.__computed_event_delegate||[],p=0;p<o.length;++p){var q=o[p];if(q instanceof n){m=q;break}}m||(m=new n(this),o.push(m)),m.on(i,e,f,g,h)}else c.prototype.on.call(this,i,e,f,g,h);return this},d.prototype.off=function(b){var e=Array.isArray(b)?b:b.split(a.EventDispatcher.EVENT_NAMESPACE_SEPARATOR),f=e[0],g=e.length>1?e[1]:void 0;if(f in d.domEvents)this.removeDomEvent(void 0,f,g);else if(f in d.computedEvents){for(var h,i=d.computedEvents[f],j=this.__computed_event_delegate=this.__computed_event_delegate||[],k=0;k<j.length;++k){var l=j[k];if(l instanceof i){h=l;break}}h&&h.off(e)}else c.prototype.off.call(this,e);return this},d.INIT_EVENT="init",d.COMPLETE_EVENT="complete",d.ATTACH_COMPONENT_EVENT="attachComponent",d.DETACH_COMPONENT_EVENT="detachComponent",d.ADDED_TO_DISPLAY_EVENT="addedToDisplay",d.REMOVED_FROM_DISPLAY_EVENT="removedFromDisplay",d.skinDiv=document.createElement("DIV"),d.domEvents={click:!0,dblclick:!0,mousedown:!0,mousemove:!0,mouseover:!0,mouseout:!0,mouseup:!0,keydown:!0,keypress:!0,keyup:!0,abort:!0,error:!0,load:!0,resize:!0,scroll:!0,unload:!0,blur:!0,change:!0,focus:!0,reset:!0,select:!0,submit:!0,focusin:!0,focusout:!0,touchstart:!0,touchend:!0,touchmove:!0,touchenter:!0,touchleave:!0,touchcancel:!0,dragstart:!0,drag:!0,dragenter:!0,dragleave:!0,dragover:!0,drop:!0,dragend:!0},d.computedEvents={},d}(a.DescribableObject);a.Component=c,Meta.Bindable(c.prototype,"model"),Meta.Bindable(c.prototype,"models"),Meta.StyleProperty(c.prototype,"width"),Meta.StyleProperty(c.prototype,"minWidth"),Meta.StyleProperty(c.prototype,"maxWidth"),Meta.StyleProperty(c.prototype,"height"),Meta.StyleProperty(c.prototype,"minHeight"),Meta.StyleProperty(c.prototype,"maxHeight"),Meta.StyleProperty(c.prototype,"top"),Meta.StyleProperty(c.prototype,"bottom"),Meta.StyleProperty(c.prototype,"left"),Meta.StyleProperty(c.prototype,"right"),Meta.StyleProperty(c.prototype,"marginTop"),Meta.StyleProperty(c.prototype,"marginBottom"),Meta.StyleProperty(c.prototype,"marginLeft"),Meta.StyleProperty(c.prototype,"marginRight"),Meta.StyleProperty(c.prototype,"paddingTop"),Meta.StyleProperty(c.prototype,"paddingBottom"),Meta.StyleProperty(c.prototype,"paddingLeft"),Meta.StyleProperty(c.prototype,"paddingRight"),Meta.StyleProperty(c.prototype,"display"),Meta.StyleProperty(c.prototype,"position"),Meta.StyleProperty(c.prototype,"flex"),Meta.StyleProperty(c.prototype,"opacity"),c.prototype.directives={text:{regexp:/^data-text$/,run:function(b,c,d){this._directive_binding.push(new a.ContentBinding(this,d,c).bind())}},html:{regexp:/^data-html$/,run:function(b,c,d){this._directive_binding.push(new a.ContentBinding(this,d,c,!0).bind())}},style:{regexp:/^data-style-(.+)$/,run:function(b,c,d){this._directive_binding.push(new a.StyleBinding(this,d,c,b[1]).bind())}},cls:{regexp:/^data-attr-class|data-class$/,run:function(b,c,d){this._directive_binding.push(new a.ClassBinding(this,d,c).bind())}},attr:{regexp:/^data-attr-(.+)$/,run:function(b,c,d){this._directive_binding.push(new a.AttributeBinding(this,d,c,b[1]).bind())}},clsSwitch:{regexp:/^data-class-(.+)$/,run:function(b,c,d){this._directive_binding.push(new a.ClassSwitchBinding(this,d,c,b[1]).bind())}},action:{regexp:/^data-action-(.+)$/,run:function(a,b,c){this._directive_action.push(this.addDomEvent(b,a[1],this.uid+"-action",this[c].bind(this)))}},attach:{regexp:/^data-attach$/,run:function(b,c,d){var e=$(c);this._directive_binding.push(new a.Watcher(this,d,function(a,b){if(b){this.detachComponent(b);for(var c=0;c<this._directive_attach.length;++c)this._directive_attach[c]===b&&this._directive_attach.splice(c,1)}a&&(this.attachComponent(a,0,e),this._directive_attach.push(a))},this).bind(!0))}},container:{regexp:/^data-container$/,run:function(a,b){this.childsContainer||(this._directive_container=!0,this.childsContainer=$(b))}}},Meta.Mixin(c.prototype,a.StateMixin);var d=function(b){function c(c){b.call(this),Object.defineProperty(this,"uid",{writable:!1,value:a.Utils.getUID()}),Object.defineProperty(this,"component",{writable:!1,value:c})}return __extends(c,b),c}(a.EventDispatcher);a.ComputedEventDelegate=d}(Coral||(Coral={}));var Coral;!function(a){var b=function(b){function c(c,d,e){if(this._value="none",name="state",b.call(this,c,d,e),this.name||(this.name="state"),this.values){this._values=a.Descriptor.instanciateAll(this.values,this.isExternal("values")?this.context:this,this),this._valuesMap={};for(var f=0;f<this._values.length;++f)this._valuesMap[this._values[f].value]=this._values[f]}this.transitions&&(this._transitions=a.Descriptor.instanciateAll(this.transitions,this.isExternal("transitions")?this.context:this,this)),this.css=this.name+"-none",this._last="none",a.Utils.callback(this.updateState,this)}return __extends(c,b),Object.defineProperty(c.prototype,"value",{get:function(){return this._value},set:function(a){this._value!==a&&(this._value=a,this._valuesMap&&this.updateState())},enumerable:!0,configurable:!0}),c.prototype.matchState=function(a){for(var b=0;b<a.length;++b)if(this._currentState&&this._currentState.matchState(a[b])||!this._currentState&&"none"==a[b])return!0;return!1},c.prototype.updateState=function(){var b=this._value,c=this.getCurrentState();if(b!==c){var d;if(this._transitions)for(var e=0;e<this._transitions.length;++e)if(this._transitions[e].match(c,b)){d=this._transitions[e];break}d?this.runningTransition?this.waitingChange={transition:d,oldValue:c,newValue:b}:(this.runningTransition=d,this.runningTransition.on([a.Task.DONE_EVENT,this.uid],this.transitionEnd,this),this.runningTransition.on([a.Task.CANCEL_EVENT,this.uid],this.transitionEnd,this),this.runningTransition.run(c,b)):this.runningTransition?this.waitingChange=b:this.triggerState(b)}},c.prototype.transitionEnd=function(){this.runningTransition.off([a.Task.DONE_EVENT,this.uid]),this.runningTransition.off([a.Task.CANCEL_EVENT,this.uid]);var b=this.waitingChange;this.waitingChange=this.runningTransition=void 0,b&&"transition"in b?(this.runningTransition=b.transition,this.runningTransition.on([a.Task.DONE_EVENT,this.uid],this.transitionEnd,this),this.runningTransition.on([a.Task.CANCEL_EVENT,this.uid],this.transitionEnd,this),this.runningTransition.run(b.oldValue,b.newValue)):b&&this.triggerState(b)},c.prototype.triggerState=function(b){var c=this.getCurrentState();this._currentState&&this._currentState.leave(),this._currentState?this._currentState.intermediate||(this._last=c):this._last="none",this._currentState=this.getStateValue(b),this._currentState&&this._currentState.enter();var d=this.getCurrentState();this.dispatch(new a.Event(a.State.CHANGE_EVENT,{stateName:this.name,oldValue:c,newValue:d})),this.css="-"+this.name+"-"+this._last+" "+this.name+"-"+d},c.prototype.getStateValue=function(a){return this._valuesMap[a]},c.prototype.getCurrentStateValue=function(){return this._currentState},c.prototype.getCurrentState=function(){return this._currentState?this._currentState.value:"none"},c.prototype.destroy=function(){if(b.prototype.destroy.call(this),this._values)for(var a=0;a<this._values.length;++a)this._values[a].destroy();if(this._transitions)for(a=0;a<this._transitions.length;++a)this._transitions[a].destroy()},c.CHANGE_EVENT="change",c}(a.DescribableObject);a.State=b;var c=function(c){function d(a,d,e){c.call(this,a,d,e),console.assert(e instanceof b,"The owner of a StateValue must be a State"),this.state=e}return __extends(d,c),d.prototype.enter=function(){this.dispatch(new a.Event(d.ENTER_STATE_EVENT))},d.prototype.leave=function(){this.dispatch(new a.Event(d.LEAVE_STATE_EVENT))},d.prototype.matchState=function(a){return this.value==a},d.ENTER_STATE_EVENT="enterState",d.LEAVE_STATE_EVENT="leaveState",d}(a.DescribableObject);a.StateValue=c;var d=function(c){function d(a,d,e){c.call(this,a,d,e),console.assert(e instanceof b,"The owner of a Transition must be a State"),this.state=e}return __extends(d,c),d.prototype.match=function(a,b){return("any"==this.from||"none"==this.from&&"none"==a||"none"!=a&&this.state.getStateValue(a).matchState(this.from))&&("any"==this.to||"none"==this.to&&"none"==b||"none"!=b&&this.state.getStateValue(b).matchState(this.to))?!0:!1},d.prototype.run=function(b,e){this.stateFrom=b,this.stateTo=e,this.dispatch(new a.Event(d.TRANSITION_START_EVENT,{stateFrom:this.stateFrom,stateTo:this.stateTo})),c.prototype.run.call(this)},d.prototype.cancel=function(){this.state.triggerState(this.stateTo),c.prototype.cancel.call(this),this.dispatch(new a.Event(d.TRANSITION_END_EVENT,{stateFrom:this.stateFrom,stateTo:this.stateTo},!0))},d.prototype.done=function(){this.state.triggerState(this.stateTo),c.prototype.done.call(this),this.dispatch(new a.Event(d.TRANSITION_END_EVENT,{stateFrom:this.stateFrom,stateTo:this.stateTo},!0))},d.TRANSITION_START_EVENT="transitionStart",d.TRANSITION_END_EVENT="transitionEnd",d}(a.SequentialTasks);a.Transition=d;var e=function(a){function b(b,c,d,e){this.time=300,a.call(this,b,c,d,e)}return __extends(b,a),b.prototype.do=function(){for(var a=this.owner;a&&!(a instanceof d);)a=a.owner;console.assert(a,"IntermediateState must be nested into a Transition to take effect"),a.state.triggerState(a.state.getStateValue(this.value));var b=this;setTimeout(function(){b.canceled||b.done()},this.time)},b}(a.Task);a.IntermediateState=e}(Coral||(Coral={}));var Coral;!function(a){var b=function(b){function c(d,e,f,g){Object.defineProperty(this,"childsCollection",{writable:!1,value:new a.Collection}),b.call(this,d,e,f,g),this.childsContainer=this.childsContainer||$(this.findTarget("")||this.el),this.childsCollection.on([a.Collection.ADD_EVENT,this.uid],this._childAdded,this),this.childsCollection.on([a.Collection.REMOVE_EVENT,this.uid],this._childRemoved,this),this.childsCollection.on([a.Collection.MOVE_EVENT,this.uid],this._childMoved,this),this.childsCollection.on([a.Collection.SET_EVENT,this.uid],this._childSet,this),this.childsFactory&&(this.childsFactory=this.childsFactory.instanciate(this.isExternal("childsFactory")?this.context:this,this),this.childsFactory.collection=this.childsCollection,this.childsFactory.external=this.areChildsExternal(),this.childsFactory.update(),this.dispatch(new a.Event(c.CHILD_COMPLETE_EVENT)))}return __extends(c,b),c.prototype.areChildsExternal=function(){return!1},Object.defineProperty(c.prototype,"layout",{get:function(){return this._layout},set:function(b){this._layout!==b&&(this._layout&&this._layout instanceof a.DescribableObject&&this._layout.destroy(),b?b instanceof a.Descriptor&&(this._layout=b.instanciate(this.isExternal("layout")?this.context:this,this)):this._layout=void 0)},enumerable:!0,configurable:!0}),c.prototype._addChild=function(b,d,e){b.isAddedToDisplay||(e||(e=this.childsContainer),e||a.Utils.error("no childsContainer is defined",this),e instanceof c?e._addChild(b,d):e instanceof $?this.attachComponent(b,d,e):a.Utils.error("this kind of target is not managed",this),this.dispatch(new a.Event(c.CHILD_ADDED_EVENT,{child:b})))},c.prototype._removeChild=function(b){var d=b.parent;d&&(d.detachComponent(b),this.dispatch(new a.Event(c.CHILD_REMOVED_EVENT,{child:b})))},c.prototype._childAdded=function(a){this._addChild(a.data.value,a.data.index)},c.prototype._childRemoved=function(a){this._removeChild(a.data.value)},c.prototype._childMoved=function(a){this._removeChild(a.data.value),this._addChild(a.data.value,a.data.to)},c.prototype._childSet=function(a){this._removeChild(a.data.oldValue),this._addChild(a.data.value,a.data.at)},c.prototype.destroy=function(){b.prototype.destroy.call(this),this.childsFactory&&this.childsFactory.destroy()},c.CHILD_ADDED_EVENT="childAdded",c.CHILD_REMOVED_EVENT="childremoved",c.CHILD_COMPLETE_EVENT="childComplete",c}(a.Component);a.BaseContainer=b}(Coral||(Coral={}));var Coral;!function(a){var b=function(a){function b(b,c,d,e){a.call(this,b,c,d,e)}return __extends(b,a),b.prototype.areChildsExternal=function(){return this.isExternal("childs")},b}(a.BaseContainer);a.Container=b,b.prototype.childsFactory=new a.Descriptor(a.DescriptorsFactory,{descriptors:new a.Bind("childs",a.Bind.SIMPLE_BINDING_MODE)})}(Coral||(Coral={}));var Coral;!function(a){var b=function(a){function b(b,c,d,e){a.call(this,b,c,d,e)}return __extends(b,a),b.prototype.areChildsExternal=function(){return this.isExternal("itemRenderer")},b}(a.BaseContainer);a.DataContainer=b,b.prototype.childsFactory=new a.Descriptor(a.DataDescriptorsFactory,{itemDescriptor:new a.Bind("itemRenderer",a.Bind.SIMPLE_BINDING_MODE),items:new a.Bind("items",a.Bind.SIMPLE_BINDING_MODE)})}(Coral||(Coral={}));var Coral;!function(a){var b=function(a){function b(b,c){a.call(this,b,c)}return __extends(b,a),b.prototype.run=function(){this.addedToDisplay()},b}(a.Container);a.Application=b}(Coral||(Coral={}));var Coral;
!function(a){var b=function(b){function c(c,d,e){b.call(this,c,d,e),console.assert(this.owner instanceof a.BaseContainer,"The owner of a Layout must be a BaseContainer"),console.assert(this.owner.childsCollection,"The owner of a Layout must have a childsCollection"),Object.defineProperty(this,"collection",{writable:!1,value:e.childsCollection}),this._childsContainerBinding=new a.Binding(this.owner,"childsContainer",this,"childsContainer").bind()}return __extends(c,b),Object.defineProperty(c.prototype,"childsContainer",{get:function(){return this._childsContainer},set:function(a){this._childsContainer!=a&&(this._childsContainer=a,this._childsContainerUpToDate=!1,this.planUpdate())},enumerable:!0,configurable:!0}),c.prototype.destroy=function(){b.prototype.destroy.call(this),this._childsContainerBinding&&this._childsContainerBinding.unbind()},c.prototype.updateLayout=function(){this._layoutUpToDate=!1,this.planUpdate()},c}(a.DescribableObject);a.Layout=b}(Coral||(Coral={})),$(function(){for(var a=$("*[data-app]"),b=0;b<a.length;++b){var c=a[b],d=new Coral.Descriptor($(c).attr("data-app"),{el:c}),e=d.instanciate(global,global);e.run()}});